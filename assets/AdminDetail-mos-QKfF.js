import{_ as V,o as r,c as i,a as e,u as _e,b as ce,F as M,r as H,n as A,t as x,d as S,e as me,f as R,w as pe,g as $,h as Ie,i as Ae,j as He,k as Z,q as Fe,l as de,m as he,p as ue,s as ee,v as te,x as Be,y as Ue,T as Re,z as Ye,A as B,B as Ee,E as Oe,C as qe,D as Ke}from"./index-D3iRISSY.js";const Qe={class:"bg-white/80 backdrop-blur-2xl border-b border-slate-200/60 sticky top-0 z-40 transition-all shadow-[0_4px_20px_-10px_rgba(0,0,0,0.05)] print:hidden"},Ve={class:"px-4 md:px-8 py-4 md:py-5"},We={class:"flex flex-col xl:flex-row xl:items-center justify-between gap-5 mb-5"},Ge={class:"flex items-center gap-4"},Je={class:"bg-slate-100/80 p-1.5 rounded-2xl flex overflow-x-auto no-scrollbar w-full xl:w-auto shadow-inner border border-slate-200/50 shrink-0"},Xe=["onClick"],Ze={class:"flex flex-wrap items-center gap-3 animate-fade-in min-h-[42px]"},et={key:0,class:"flex items-center gap-3 bg-white px-4 py-2 rounded-xl border border-slate-200 shadow-sm focus-within:border-indigo-500 w-full sm:w-auto"},tt=["value"],ot={key:1,class:"flex gap-2 w-full sm:w-auto"},at={class:"relative group flex-1 sm:flex-none"},lt=["value"],st=["value"],nt={class:"relative group flex-1 sm:flex-none"},rt=["value"],it=["value"],dt={key:2,class:"relative group w-full sm:w-auto"},ut=["value"],pt=["value"],ct={key:3,class:"flex items-center gap-3 bg-white px-4 py-2 rounded-xl border border-slate-200 shadow-sm focus-within:border-indigo-500 w-full sm:w-auto"},gt=["value"],bt=["value"],xt={__name:"AdminDetailHeader",props:{dateFilterType:String,selectedDate:String,selectedMonth:[String,Number],selectedYear:[String,Number],customStart:String,customEnd:String,availableYears:Array,availableMonths:Array,isLoadingPage:Boolean},emits:["update:dateFilterType","update:selectedDate","update:selectedMonth","update:selectedYear","update:customStart","update:customEnd"],setup(l,{emit:Y}){const m=me(),u=[{key:"daily",label:"ប្រចាំថ្ងៃ"},{key:"monthly",label:"ប្រចាំខែ"},{key:"yearly",label:"ប្រចាំឆ្នាំ"},{key:"custom",label:"កំណត់ថ្ងៃ"}];return(h,d)=>(r(),i("div",Qe,[e("div",Ve,[e("div",We,[e("div",Ge,[e("button",{onClick:d[0]||(d[0]=s=>_e(m).back()),class:"w-10 h-10 rounded-full bg-slate-100 hover:bg-slate-200 text-slate-600 flex items-center justify-center transition-colors"},[...d[7]||(d[7]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 19l-7-7m0 0l7-7m-7 7h18"})],-1)])]),d[8]||(d[8]=ce('<div class="w-12 h-12 rounded-2xl bg-gradient-to-br from-slate-700 to-indigo-900 flex items-center justify-center shadow-lg shadow-slate-500/30 text-white shrink-0" data-v-1cb92d49><svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-1cb92d49><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z" data-v-1cb92d49></path></svg></div><div data-v-1cb92d49><h1 class="text-xl md:text-2xl font-black text-slate-800 tracking-tight leading-tight" data-v-1cb92d49>ព័ត៌មានលម្អិតអ្នកគ្រប់គ្រង</h1><p class="text-slate-500 text-[11px] md:text-xs font-bold mt-0.5 uppercase tracking-wider" data-v-1cb92d49>Admin Report Details</p></div>',2))]),e("div",Je,[(r(),i(M,null,H(u,s=>e("button",{key:s.key,onClick:f=>h.$emit("update:dateFilterType",s.key),class:A(["flex-1 xl:flex-none px-5 py-2.5 rounded-xl text-xs md:text-sm font-bold transition-all duration-300 whitespace-nowrap relative",l.dateFilterType===s.key?"text-indigo-600 shadow-md bg-white":"text-slate-500 hover:text-slate-800 hover:bg-slate-200/50"])},x(s.label),11,Xe)),64))])]),e("div",Ze,[l.isLoadingPage?S("",!0):(r(),i(M,{key:0},[l.dateFilterType==="daily"?(r(),i("div",et,[d[9]||(d[9]=e("span",{class:"text-slate-400 text-[10px] font-black uppercase tracking-wider"},"ថ្ងៃទី",-1)),e("input",{value:l.selectedDate,onInput:d[1]||(d[1]=s=>h.$emit("update:selectedDate",s.target.value)),type:"date",class:"w-full bg-transparent border-none text-slate-700 font-bold text-sm focus:ring-0 outline-none p-0 cursor-pointer"},null,40,tt)])):S("",!0),l.dateFilterType==="monthly"?(r(),i("div",ot,[e("div",at,[e("select",{value:l.selectedMonth,onChange:d[2]||(d[2]=s=>h.$emit("update:selectedMonth",s.target.value)),class:"w-full appearance-none bg-white border border-slate-200 pl-4 pr-10 py-2.5 rounded-xl text-sm font-bold text-slate-700 outline-none shadow-sm cursor-pointer min-w-[140px]"},[(r(!0),i(M,null,H(l.availableMonths,s=>(r(),i("option",{key:s.index,value:s.index},x(s.name),9,st))),128))],40,lt),d[10]||(d[10]=e("svg",{class:"w-4 h-4 absolute right-3 top-1/2 -translate-y-1/2 text-slate-400 pointer-events-none",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"})],-1))]),e("div",nt,[e("select",{value:l.selectedYear,onChange:d[3]||(d[3]=s=>h.$emit("update:selectedYear",s.target.value)),class:"w-full appearance-none bg-white border border-slate-200 pl-4 pr-10 py-2.5 rounded-xl text-sm font-bold text-slate-700 outline-none shadow-sm cursor-pointer"},[(r(!0),i(M,null,H(l.availableYears,s=>(r(),i("option",{key:s,value:s},x(s),9,it))),128))],40,rt),d[11]||(d[11]=e("svg",{class:"w-4 h-4 absolute right-3 top-1/2 -translate-y-1/2 text-slate-400 pointer-events-none",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"})],-1))])])):S("",!0),l.dateFilterType==="yearly"?(r(),i("div",dt,[e("select",{value:l.selectedYear,onChange:d[4]||(d[4]=s=>h.$emit("update:selectedYear",s.target.value)),class:"w-full appearance-none bg-white border border-slate-200 pl-4 pr-10 py-2.5 rounded-xl text-sm font-bold text-slate-700 outline-none shadow-sm cursor-pointer min-w-[120px]"},[(r(!0),i(M,null,H(l.availableYears,s=>(r(),i("option",{key:s,value:s},x(s),9,pt))),128))],40,ut),d[12]||(d[12]=e("svg",{class:"w-4 h-4 absolute right-3 top-1/2 -translate-y-1/2 text-slate-400 pointer-events-none",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"})],-1))])):S("",!0),l.dateFilterType==="custom"?(r(),i("div",ct,[e("input",{value:l.customStart,onInput:d[5]||(d[5]=s=>h.$emit("update:customStart",s.target.value)),type:"date",class:"w-full flex-1 bg-transparent border-none text-slate-700 font-bold text-sm focus:ring-0 outline-none p-0 cursor-pointer"},null,40,gt),d[13]||(d[13]=e("div",{class:"w-4 h-px bg-slate-300"},null,-1)),e("input",{value:l.customEnd,onInput:d[6]||(d[6]=s=>h.$emit("update:customEnd",s.target.value)),type:"date",class:"w-full flex-1 bg-transparent border-none text-slate-700 font-bold text-sm focus:ring-0 outline-none p-0 cursor-pointer"},null,40,bt)])):S("",!0)],64))])])]))}},ft=V(xt,[["__scopeId","data-v-1cb92d49"]]),vt={class:"bg-gradient-to-r from-slate-800 to-indigo-900 p-6 md:p-8 rounded-[2rem] text-white relative overflow-hidden shadow-lg mb-8 print:hidden"},ht={class:"flex flex-col md:flex-row gap-6 relative z-10"},mt=["src"],yt={class:"flex-1"},wt={class:"text-3xl font-black mb-1"},kt={class:"flex flex-wrap items-center gap-3 text-sm font-medium text-slate-300 mb-4"},$t={class:"bg-white/10 px-2.5 py-1 rounded-lg font-mono"},St=["href"],Ct={class:"flex items-center gap-2"},Tt={class:"bg-white/10 px-3 py-1.5 rounded-lg flex items-center gap-2"},Dt={class:"text-xs font-bold text-white"},Mt={class:"flex flex-col lg:flex-row justify-between items-center gap-4 mb-6 print:hidden"},zt={class:"flex items-center gap-2 bg-white p-1.5 rounded-2xl w-full sm:w-fit border border-slate-200 shadow-sm shrink-0 relative z-30"},jt={class:"flex flex-col sm:flex-row items-center gap-3 w-full lg:w-auto bg-white p-2 rounded-2xl shadow-sm border border-slate-200 shrink-0 z-20"},Lt={class:"relative w-full sm:w-64"},Nt=["value"],Pt={class:"flex items-center gap-2 w-full sm:w-auto justify-end"},_t={key:0,class:"bg-slate-100 p-1.5 rounded-xl flex border border-slate-200 animate-fade-in shrink-0"},It=["disabled"],At=["disabled"],Ht={__name:"AdminDetailProfileCard",props:{admin:Object,totalSellersCount:Number,activeTab:String,searchQuery:String,activeCategory:String,filteredSellersLength:Number,processing:Object},emits:["update:activeTab","update:searchQuery","update:activeCategory","print","pdf"],setup(l,{emit:Y}){return(m,u)=>(r(),i("div",null,[e("div",vt,[u[11]||(u[11]=e("div",{class:"absolute -right-10 -top-10 w-40 h-40 bg-white/10 rounded-full blur-3xl"},null,-1)),e("div",ht,[e("img",{src:l.admin.photoUrl||`https://ui-avatars.com/api/?name=${l.admin.fullName}`,class:"w-24 h-24 rounded-3xl object-cover border-4 border-white/20 shadow-xl shrink-0 bg-white"},null,8,mt),e("div",yt,[e("h2",wt,x(l.admin.fullName),1),e("div",kt,[e("span",$t,"@"+x(l.admin.username),1),l.admin.telegram?(r(),i("a",{key:0,href:"https://t.me/"+l.admin.telegram.replace("@",""),target:"_blank",class:"flex items-center gap-1.5 text-sky-400 hover:text-sky-300 transition-colors"},[u[9]||(u[9]=e("svg",{class:"w-4 h-4",fill:"currentColor",viewBox:"0 0 24 24"},[e("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm4.64 6.8c-.15 1.58-.8 5.42-1.13 7.19-.14.75-.42 1-.68 1.03-.58.05-1.02-.38-1.58-.75-.88-.58-1.48-.94-2.4-1.54-1.06-.7-.37-1.09.23-1.72.16-.16 2.87-2.63 2.92-2.85.01-.03.01-.14-.06-.2-.06-.06-.17-.04-.25-.02-.11.02-1.91 1.2-5.39 3.55-.5.34-.95.51-1.35.5-.44-.01-1.29-.25-1.92-.42-.77-.21-1.37-.32-1.31-.68.03-.18.28-.37.76-.56 3.03-1.32 5.06-2.19 6.09-2.62 2.93-1.21 3.53-1.43 3.93-1.43.09 0 .28.01.4.04.1.03.24.1.33.25.08.16.07.32.07.33z"})],-1)),R(" "+x(l.admin.telegram),1)],8,St)):S("",!0)]),e("div",Ct,[e("div",Tt,[u[10]||(u[10]=e("span",{class:"w-2 h-2 rounded-full bg-emerald-400"},null,-1)),e("span",Dt,"តំណាងលក់សរុប: "+x(l.totalSellersCount)+" នាក់",1)])])])])]),e("div",Mt,[e("div",zt,[e("button",{onClick:u[0]||(u[0]=h=>m.$emit("update:activeTab","sellers")),class:A([l.activeTab==="sellers"?"bg-indigo-50 text-indigo-600":"text-slate-500 hover:text-slate-800","flex-1 sm:flex-none px-6 py-2.5 rounded-xl text-sm font-bold transition-all duration-300"])}," បញ្ជីតំណាងលក់ ",2),e("button",{onClick:u[1]||(u[1]=h=>m.$emit("update:activeTab","report")),class:A([l.activeTab==="report"?"bg-indigo-50 text-indigo-600":"text-slate-500 hover:text-slate-800","flex-1 sm:flex-none px-6 py-2.5 rounded-xl text-sm font-bold transition-all duration-300"])}," របាយការណ៍លក់ ",2)]),e("div",jt,[e("div",Lt,[u[13]||(u[13]=e("span",{class:"absolute inset-y-0 left-0 pl-3 flex items-center text-slate-400 pointer-events-none"},[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})])],-1)),e("input",{value:l.searchQuery,onInput:u[2]||(u[2]=h=>m.$emit("update:searchQuery",h.target.value)),type:"text",placeholder:"ស្វែងរកឈ្មោះ ឬ អត្តលេខ...",class:"w-full pl-9 pr-4 py-2 bg-slate-50 border border-slate-200 rounded-xl text-sm font-bold focus:bg-white focus:ring-2 focus:ring-indigo-500/20 outline-none transition-all placeholder:font-normal"},null,40,Nt),l.searchQuery?(r(),i("button",{key:0,onClick:u[3]||(u[3]=h=>m.$emit("update:searchQuery","")),class:"absolute inset-y-0 right-2 flex items-center text-slate-400 hover:text-rose-500"},[...u[12]||(u[12]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])):S("",!0)]),e("div",Pt,[l.activeTab==="report"?(r(),i("div",_t,[e("button",{onClick:u[4]||(u[4]=h=>m.$emit("update:activeCategory","all")),class:A([l.activeCategory==="all"?"bg-white shadow-sm text-slate-800":"text-slate-500 hover:text-slate-700","px-3 py-1.5 rounded-lg text-xs font-bold transition-all"])},"ទាំងអស់",2),e("button",{onClick:u[5]||(u[5]=h=>m.$emit("update:activeCategory","បោះដុំ")),class:A([l.activeCategory==="បោះដុំ"?"bg-white shadow-sm text-purple-700":"text-slate-500 hover:text-purple-700","px-3 py-1.5 rounded-lg text-xs font-bold transition-all"])},"បោះដុំ",2),e("button",{onClick:u[6]||(u[6]=h=>m.$emit("update:activeCategory","លក់រាយ")),class:A([l.activeCategory==="លក់រាយ"?"bg-white shadow-sm text-indigo-600":"text-slate-500 hover:text-indigo-600","px-3 py-1.5 rounded-lg text-xs font-bold transition-all"])},"លក់រាយ",2)])):S("",!0),e("button",{onClick:u[7]||(u[7]=h=>m.$emit("print")),disabled:l.filteredSellersLength===0,class:"bg-slate-800 hover:bg-slate-900 text-white px-3 py-2 rounded-xl text-xs font-bold shadow-md transition-all active:scale-95 disabled:opacity-50 flex items-center justify-center gap-1.5 shrink-0"},[...u[14]||(u[14]=[e("svg",{class:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2-2v4h10z"})],-1),R(" Print ",-1)])],8,It),e("button",{onClick:u[8]||(u[8]=h=>m.$emit("pdf")),disabled:l.filteredSellersLength===0||l.processing.active,class:"bg-rose-500 hover:bg-rose-600 text-white px-3 py-2 rounded-xl text-xs font-bold shadow-md shadow-rose-500/30 transition-all active:scale-95 disabled:opacity-50 flex items-center justify-center gap-1.5 shrink-0"},[...u[15]||(u[15]=[e("svg",{class:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1),R(" PDF ",-1)])],8,At)])])])]))}},Ft=V(Ht,[["__scopeId","data-v-1546ed00"]]),Bt={key:0,class:"flex-1 flex items-center justify-center py-20 print:hidden"},Ut={key:1,class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-5 animate-fade-in print:hidden"},Rt=["onClick"],Yt={class:"flex gap-4 items-start"},Et=["src"],Ot={class:"flex-1 min-w-0"},qt={class:"font-black text-slate-800 text-lg truncate leading-tight mb-1 group-hover:text-indigo-600 transition-colors"},Kt={class:"text-xs font-mono text-slate-500 mb-2 truncate"},Qt=["href"],Vt={class:"mt-5 pt-4 border-t border-slate-100 flex flex-col gap-2"},Wt={class:"bg-slate-50 px-3 py-2 rounded-xl flex items-center justify-center text-sm font-bold text-slate-600 gap-2 border border-slate-100"},Gt={key:2,class:"bg-white rounded-3xl border border-slate-200 overflow-hidden shadow-sm animate-fade-in print:hidden"},Jt={class:"overflow-x-auto"},Xt={class:"w-full text-left border-collapse min-w-[900px]"},Zt={class:"divide-y divide-slate-100"},eo=["onClick"],to={class:"px-6 py-4 text-center text-sm font-bold text-slate-400 align-top pt-6"},oo={class:"px-6 py-4 align-top pt-5"},ao={class:"flex items-center gap-4"},lo=["src"],so={class:"font-bold text-base text-slate-800 transition-colors group-hover:text-indigo-600"},no={class:"px-6 py-4 align-top pt-6"},ro={key:0,class:"font-bold text-slate-700 text-sm bg-slate-100 px-3 py-1.5 rounded-lg border border-slate-200"},io={key:1,class:"text-slate-300 font-bold"},uo={class:"px-6 py-4 align-top pt-5"},po={key:0,class:"flex flex-wrap gap-2 items-center mt-1"},co=["onClick"],go={key:0},bo={key:1},xo={key:1,class:"text-xs font-bold text-slate-300 mt-1 block"},fo={class:"px-6 py-4 text-center align-top pt-6"},vo={key:1,class:"text-slate-300 font-bold"},ho={class:"px-6 py-4 text-center align-top pt-6"},mo={key:0,class:"inline-flex items-center px-3 py-1 bg-amber-50 text-amber-600 rounded-lg text-xs font-bold border border-amber-100 shadow-sm"},yo={key:1,class:"text-xs text-slate-300 font-bold"},wo={class:"px-6 py-4 text-right align-top pt-5"},ko={key:0,class:"flex flex-col items-end leading-tight gap-1.5"},$o={class:"text-emerald-700 font-black text-sm bg-emerald-50 px-2.5 py-0.5 rounded-lg border border-emerald-100 shadow-sm"},So={class:"text-blue-600 font-bold text-xs"},Co={key:1,class:"text-sm text-slate-300 font-bold"},To={key:3,class:"mt-6 flex justify-between items-center bg-white p-4 rounded-2xl border border-slate-200 shadow-sm print:hidden"},Do={class:"text-xs font-bold text-slate-500 pl-2"},Mo={class:"flex items-center gap-1.5"},zo=["disabled"],jo=["onClick"],Lo=["disabled"],No={__name:"AdminDetailList",props:{activeTab:String,filteredSellers:Array,paginatedSellers:Array,currentPage:Number,totalPages:Number,itemsPerPage:Number,unitSettings:Array},emits:["goToPage","prevPage","nextPage","goToSellerDetail"],setup(l,{emit:Y}){const m=l,u=$(new Set),h=f=>{const p=new Set(u.value);p.has(f)?p.delete(f):p.add(f),u.value=p},d=f=>{if(!f)return"";const p=String(f),n=m.unitSettings.find(T=>String(T.value)===p);if(n)return n.label;const y=p.toLowerCase().trim();return y==="bottle"||y==="bottles"?"ដប":y==="pack"||y==="packs"?"កញ្ចប់":y==="case"||y==="cases"?"កេះ":p},s=f=>{if(!f)return"text-slate-700 bg-slate-50 border-slate-200";const p=String(f),n=m.unitSettings.find(C=>String(C.value)===p),y=n?n.color:"slate",T={cyan:"text-cyan-700 bg-cyan-50 border-cyan-200",purple:"text-purple-700 bg-purple-50 border-purple-200",amber:"text-amber-700 bg-amber-50 border-amber-200",rose:"text-rose-700 bg-rose-50 border-rose-200",emerald:"text-emerald-700 bg-emerald-50 border-emerald-200",blue:"text-blue-700 bg-blue-50 border-blue-200",slate:"text-slate-700 bg-slate-50 border-slate-200"};return T[y]||T.slate};return(f,p)=>(r(),i("div",null,[l.filteredSellers.length===0?(r(),i("div",Bt,[...p[3]||(p[3]=[ce('<div class="text-center bg-white p-12 rounded-[2rem] border-2 border-dashed border-slate-200" data-v-ab0a5de2><div class="w-20 h-20 bg-slate-50 text-slate-400 rounded-full flex items-center justify-center mx-auto mb-4" data-v-ab0a5de2><svg class="w-10 h-10" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-ab0a5de2><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" data-v-ab0a5de2></path></svg></div><p class="text-slate-500 font-bold text-xl" data-v-ab0a5de2>មិនមានទិន្នន័យទេ</p><p class="text-slate-400 text-sm mt-2" data-v-ab0a5de2>សូមព្យាយាមស្វែងរកម្ដងទៀត ឬផ្លាស់ប្តូរកាលបរិច្ឆេទ</p></div>',1)])])):l.activeTab==="sellers"?(r(),i("div",Ut,[(r(!0),i(M,null,H(l.paginatedSellers,n=>(r(),i("div",{key:n.id,onClick:y=>f.$emit("goToSellerDetail",n.id),class:"bg-white p-6 rounded-3xl border border-slate-200 shadow-sm hover:shadow-md hover:border-indigo-200 transition-all flex flex-col justify-between group cursor-pointer"},[e("div",Yt,[e("img",{src:n.photoUrl||`https://ui-avatars.com/api/?name=${n.fullName}`,class:"w-16 h-16 rounded-2xl object-cover border border-slate-100 shadow-sm group-hover:scale-105 transition-transform shrink-0"},null,8,Et),e("div",Ot,[e("h4",qt,x(n.fullName),1),e("p",Kt,"ID: "+x(n.idNumber||"N/A"),1),n.telegram?(r(),i("a",{key:0,href:"https://t.me/"+n.telegram.replace("@",""),target:"_blank",onClick:p[0]||(p[0]=pe(()=>{},["stop"])),class:"inline-flex items-center gap-1.5 text-[11px] font-bold text-sky-600 bg-sky-50 px-2.5 py-1 rounded-lg hover:bg-sky-500 hover:text-white transition-colors"},[p[4]||(p[4]=e("svg",{class:"w-3.5 h-3.5",fill:"currentColor",viewBox:"0 0 24 24"},[e("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm4.64 6.8c-.15 1.58-.8 5.42-1.13 7.19-.14.75-.42 1-.68 1.03-.58.05-1.02-.38-1.58-.75-.88-.58-1.48-.94-2.4-1.54-1.06-.7-.37-1.09.23-1.72.16-.16 2.87-2.63 2.92-2.85.01-.03.01-.14-.06-.2-.06-.06-.17-.04-.25-.02-.11.02-1.91 1.2-5.39 3.55-.5.34-.95.51-1.35.5-.44-.01-1.29-.25-1.92-.42-.77-.21-1.37-.32-1.31-.68.03-.18.28-.37.76-.56 3.03-1.32 5.06-2.19 6.09-2.62 2.93-1.21 3.53-1.43 3.93-1.43.09 0 .28.01.4.04.1.03.24.1.33.25.08.16.07.32.07.33z"})],-1)),R(" @"+x(n.telegram.replace("@","")),1)],8,Qt)):S("",!0)])]),e("div",Vt,[e("span",Wt,[p[5]||(p[5]=e("svg",{class:"w-4 h-4 text-slate-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})],-1)),R(" "+x(n.phoneNumber||"N/A"),1)])])],8,Rt))),128))])):l.activeTab==="report"?(r(),i("div",Gt,[e("div",Jt,[e("table",Xt,[p[6]||(p[6]=e("thead",{class:"bg-slate-50 text-slate-500 text-[11px] uppercase font-black tracking-widest border-b border-slate-200"},[e("tr",null,[e("th",{class:"px-6 py-5 text-center w-16 whitespace-nowrap"},"#"),e("th",{class:"px-6 py-5 whitespace-nowrap"},"តំណាងលក់"),e("th",{class:"px-6 py-5 whitespace-nowrap w-48"},"ប្រភេទ (ទំនិញ)"),e("th",{class:"px-6 py-5 w-[25%] whitespace-nowrap"},"ចំនួនលក់ (UNITS)"),e("th",{class:"px-6 py-5 text-center whitespace-nowrap"},"ការលក់ (TYPE)"),e("th",{class:"px-6 py-5 text-center whitespace-nowrap"},"អតិថិជន"),e("th",{class:"px-6 py-5 text-right whitespace-nowrap"},"ចំណូល")])],-1)),e("tbody",Zt,[(r(!0),i(M,null,H(l.paginatedSellers,(n,y)=>(r(),i("tr",{key:n.uniqueId,onClick:T=>f.$emit("goToSellerDetail",n.id),class:"hover:bg-slate-50/80 transition-colors group cursor-pointer"},[e("td",to,x((l.currentPage-1)*l.itemsPerPage+y+1),1),e("td",oo,[e("div",ao,[e("img",{src:n.photoUrl||`https://ui-avatars.com/api/?name=${n.fullName}`,class:"w-12 h-12 rounded-xl object-cover border border-slate-200 shadow-sm shrink-0"},null,8,lo),e("p",so,x(n.fullName),1)])]),e("td",no,[n.hasSales?(r(),i("span",ro,x(n.productName),1)):(r(),i("span",io,"-"))]),e("td",uo,[n.hasSales?(r(),i("div",po,[(r(!0),i(M,null,H(n.unitCounts||{},(T,C,_)=>(r(),i(M,{key:C},[_<3||u.value.has(n.uniqueId)?(r(),i("span",{key:0,class:A(["inline-flex items-center px-2.5 py-1 rounded-lg text-[11px] font-bold shadow-sm border whitespace-nowrap",s(C)])},x(T.toLocaleString())+" "+x(d(C)),3)):S("",!0)],64))),128)),Object.keys(n.unitCounts||{}).length>3?(r(),i("button",{key:0,onClick:pe(T=>h(n.uniqueId),["stop"]),class:"text-[11px] text-indigo-600 font-bold hover:text-indigo-800 bg-indigo-50 px-2.5 py-1 rounded-lg transition-colors border border-indigo-100 whitespace-nowrap"},[u.value.has(n.uniqueId)?(r(),i("span",bo,"បង្រួម")):(r(),i("span",go,"+"+x(Object.keys(n.unitCounts).length-3)+" ទៀត",1))],8,co)):S("",!0)])):(r(),i("span",xo,"គ្មានការលក់"))]),e("td",fo,[n.hasSales?(r(),i("span",{key:0,class:A([n.saleType==="បោះដុំ"?"bg-purple-50 text-purple-700 border-purple-200":"bg-indigo-50 text-indigo-600 border-indigo-200","px-3 py-1.5 rounded-lg text-[11px] font-black border tracking-wider"])},x(n.saleType),3)):(r(),i("span",vo,"-"))]),e("td",ho,[n.hasSales?(r(),i("span",mo,x(n.totalClients?.toLocaleString()||0)+" នាក់",1)):(r(),i("span",yo,"-"))]),e("td",wo,[n.hasSales?(r(),i("div",ko,[e("span",$o,x(n.revenueUSD?.toLocaleString()||0)+" $",1),e("span",So,x(n.revenueKHR?.toLocaleString()||0)+" ៛",1)])):(r(),i("span",Co,"-"))])],8,eo))),128))])])])])):S("",!0),l.totalPages>1?(r(),i("div",To,[e("p",Do," បង្ហាញទំព័រ "+x(l.currentPage)+" នៃ "+x(l.totalPages),1),e("div",Mo,[e("button",{onClick:p[1]||(p[1]=n=>f.$emit("prevPage")),disabled:l.currentPage===1,class:"w-9 h-9 flex items-center justify-center rounded-xl border border-slate-200 text-slate-600 hover:bg-slate-50 disabled:opacity-30 disabled:cursor-not-allowed transition-colors"},[...p[7]||(p[7]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1)])],8,zo),(r(!0),i(M,null,H(l.totalPages,n=>(r(),i("button",{key:n,onClick:y=>f.$emit("goToPage",n),class:A(["w-9 h-9 flex items-center justify-center rounded-xl font-bold text-sm transition-colors border",l.currentPage===n?"bg-indigo-600 text-white border-indigo-600 shadow-md":"bg-white text-slate-600 border-slate-200 hover:bg-slate-50"])},x(n),11,jo))),128)),e("button",{onClick:p[2]||(p[2]=n=>f.$emit("nextPage")),disabled:l.currentPage===l.totalPages,class:"w-9 h-9 flex items-center justify-center rounded-xl border border-slate-200 text-slate-600 hover:bg-slate-50 disabled:opacity-30 disabled:cursor-not-allowed transition-colors"},[...p[8]||(p[8]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1)])],8,Lo)])])):S("",!0)]))}},Po=V(No,[["__scopeId","data-v-ab0a5de2"]]),_o={class:"fixed bottom-6 left-0 right-0 px-4 md:px-8 pointer-events-none flex justify-center z-50 animate-slide-up print:hidden"},Io={class:"bg-white/95 backdrop-blur-xl border border-slate-200 shadow-[0_10px_40px_rgba(0,0,0,0.15)] p-4 md:px-8 md:py-4 rounded-3xl md:rounded-[2rem] pointer-events-auto flex flex-col md:flex-row items-center gap-4 md:gap-8 max-w-5xl w-full"},Ao={class:"flex-1 flex justify-between md:justify-end items-center gap-6 w-full overflow-x-auto no-scrollbar"},Ho={class:"flex items-center gap-2"},Fo={key:0,class:"text-sm font-black text-slate-700 bg-slate-50 px-3 py-1.5 rounded-xl border border-slate-200 shadow-sm whitespace-nowrap"},Bo={key:0},Uo={key:1},Ro={class:"text-right shrink-0 flex items-center gap-5"},Yo={class:"text-base font-black text-slate-700"},Eo={class:"text-2xl font-black text-emerald-600 leading-none"},Oo={class:"text-sm font-bold text-blue-600 mt-1"},qo={__name:"AdminDetailBottomSummary",props:{grandTotals:Object,unitSettings:Array},setup(l){const Y=l,m=$(new Set),u=d=>{const s=new Set(m.value);s.has(d)?s.delete(d):s.add(d),m.value=s},h=d=>{if(!d)return"";const s=String(d),f=Y.unitSettings.find(n=>String(n.value)===s);if(f)return f.label;const p=s.toLowerCase().trim();return p==="bottle"||p==="bottles"?"ដប":p==="pack"||p==="packs"?"កញ្ចប់":p==="case"||p==="cases"?"កេះ":s};return(d,s)=>(r(),i("div",_o,[e("div",Io,[s[6]||(s[6]=ce('<div class="flex items-center gap-3 w-full md:w-auto border-b md:border-b-0 md:border-r border-slate-200 pb-3 md:pb-0 md:pr-8 shrink-0" data-v-b61e5980><div class="w-12 h-12 bg-indigo-600 text-white rounded-2xl flex items-center justify-center shadow-lg shadow-indigo-500/30 shrink-0" data-v-b61e5980><svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-b61e5980><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6" data-v-b61e5980></path></svg></div><div data-v-b61e5980><p class="text-slate-400 text-[11px] font-black uppercase tracking-widest" data-v-b61e5980>សរុបរួម</p><p class="text-slate-800 font-black text-base uppercase" data-v-b61e5980>Grand Total</p></div></div>',1)),e("div",Ao,[e("div",Ho,[Object.keys(l.grandTotals.all.units).length>0?(r(),i(M,{key:0},[(r(!0),i(M,null,H(l.grandTotals.all.units,(f,p,n)=>(r(),i(M,{key:p},[n<3||m.value.has("grandTotal")?(r(),i("span",Fo,x(f.toLocaleString())+" "+x(h(p)),1)):S("",!0)],64))),128)),Object.keys(l.grandTotals.all.units).length>3?(r(),i("button",{key:0,onClick:s[0]||(s[0]=pe(f=>u("grandTotal"),["stop"])),class:"text-xs font-bold text-indigo-600 hover:text-indigo-800 bg-indigo-50 px-3 py-2 rounded-xl transition-colors flex items-center gap-1 border border-indigo-100 whitespace-nowrap shadow-sm"},[m.value.has("grandTotal")?(r(),i("span",Uo,"បង្រួម")):(r(),i("span",Bo,"+"+x(Object.keys(l.grandTotals.all.units).length-3)+" ទៀត",1))])):S("",!0)],64)):S("",!0)]),s[5]||(s[5]=e("div",{class:"h-10 w-px bg-slate-200 hidden md:block shrink-0"},null,-1)),e("div",Ro,[e("div",null,[s[2]||(s[2]=e("p",{class:"text-[11px] text-slate-400 font-bold uppercase mb-0.5"},"អតិថិជនសរុប",-1)),e("p",Yo,[R(x(l.grandTotals.all.clients.toLocaleString())+" ",1),s[1]||(s[1]=e("span",{class:"text-xs font-bold text-slate-400"},"នាក់",-1))])]),s[4]||(s[4]=e("div",{class:"h-10 w-px bg-slate-200 hidden md:block"},null,-1)),e("div",null,[e("p",Eo,[R(x(l.grandTotals.all.usd.toLocaleString())+" ",1),s[3]||(s[3]=e("span",{class:"text-base opacity-80"},"$",-1))]),e("p",Oo,x(l.grandTotals.all.khr.toLocaleString())+" ៛",1)])])])])]))}},Ko=V(qo,[["__scopeId","data-v-b61e5980"]]),Qo={class:"min-h-[100dvh] bg-[#F4F7FE] font-khmer flex flex-col relative print-container print:bg-white pb-32"},Vo={key:0,class:"flex-1 flex flex-col items-center justify-center py-32 opacity-60 print:hidden"},Wo={key:1,class:"flex-1 w-full max-w-[90rem] mx-auto p-4 md:p-8 print:p-0"},Go={key:0,class:"fixed inset-0 z-[999999] flex items-center justify-center p-6 bg-slate-900/60 backdrop-blur-md print:hidden"},Jo={class:"w-full max-w-sm bg-[#18181b] border border-white/10 rounded-3xl p-10 shadow-2xl relative flex flex-col items-center text-center animate-fade-in-up"},Xo={class:"relative w-20 h-20 mb-8"},Zo={class:"absolute inset-0 flex items-center justify-center font-bold text-white text-lg font-mono"},ea={class:"text-xl font-bold text-white mb-2"},ta={class:"w-full h-1.5 bg-black/50 rounded-full overflow-hidden border border-white/5 mt-4"},oe=12,oa={__name:"AdminDetail",setup(l){const Y=Ye(),m=me(),u=Y.params.id,h=$(!0),d=$({}),s=$([]),f=$([]),p=$([]),n=$("all"),y=$("monthly"),T=$(new Date().toISOString().split("T")[0]),C=$(new Date().getFullYear()),_=$(new Date().getMonth()),W=$(new Date().toISOString().split("T")[0]),G=$(new Date().toISOString().split("T")[0]),ae=["មករា","កុម្ភៈ","មីនា","មេសា","ឧសភា","មិថុនា","កក្កដា","សីហា","កញ្ញា","តុលា","វិច្ឆិកា","ធ្នូ"],z=$("sellers"),le=$("list"),E=$(""),N=$(1),O=$(null),j=$({active:!1,message:"",progress:0});Ie(async()=>{if(!u){m.back();return}try{const a=await Ae(He(Z,"users",u));if(a.exists())d.value={id:a.id,...a.data()};else{m.back();return}const t=Fe(de(Z,"users"),he("role","in",["seller","dealer"]),he("createdBy","==",u)),o=await ue(t);s.value=o.docs.map(c=>({id:c.id,...c.data()})).filter(c=>c.isDeleted===!1||c.isDeleted==="false"||!c.isDeleted);const g=await ue(de(Z,"sales_reports"));f.value=g.docs.map(c=>({id:c.id,...c.data()}));const b=await ue(de(Z,"settings_units"));if(p.value=b.docs.map(c=>c.data()),f.value.length>0){const c=f.value.filter(w=>w.createdAt||w.date);if(c.length>0){const w=c.map(D=>D.createdAt||D.date).sort((D,K)=>new Date(K)-new Date(D))[0],v=new Date(w);C.value=v.getFullYear(),_.value=v.getMonth();const P=v.getFullYear(),I=String(v.getMonth()+1).padStart(2,"0"),L=String(v.getDate()).padStart(2,"0");T.value=`${P}-${I}-${L}`}}}catch(a){console.error("Error fetching data:",a)}finally{h.value=!1}});const ye=B(()=>{if(f.value.length===0)return[new Date().getFullYear()];const a=new Set(f.value.map(t=>{const o=t.createdAt||t.date;return o?new Date(o).getFullYear():new Date().getFullYear()}));return Array.from(a).sort((t,o)=>o-t)}),ge=B(()=>{if(f.value.length===0)return[{index:new Date().getMonth(),name:ae[new Date().getMonth()]}];const a=f.value.filter(o=>{const g=o.createdAt||o.date;return g&&new Date(g).getFullYear()===parseInt(C.value)}),t=new Set(a.map(o=>new Date(o.createdAt||o.date).getMonth()));return Array.from(t).sort((o,g)=>o-g).map(o=>({index:o,name:ae[o]}))});ee(C,()=>{const a=ge.value;a.find(t=>t.index===_.value)||a.length>0&&(_.value=a[a.length-1].index)});const we=a=>{if(!a)return!1;const t=new Date(a);if(isNaN(t.getTime()))return!1;const o=t.getFullYear(),g=t.getMonth(),b=`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}-${String(t.getDate()).padStart(2,"0")}`;return y.value==="daily"?b===T.value:y.value==="monthly"?g===parseInt(_.value)&&o===parseInt(C.value):y.value==="yearly"?o===parseInt(C.value):y.value==="custom"?b>=W.value&&b<=G.value:!1},be=B(()=>{const a=f.value.filter(o=>we(o.createdAt||o.date)&&o.paymentStatus!=="CANCELED");if(z.value==="sellers")return s.value.map(o=>({...o,uniqueId:o.id}));let t=[];return s.value.forEach(o=>{const g=a.filter(w=>(w.uid||w.sellerId)===o.id||w.sellerName===o.fullName);let b=!1,c={productNames:new Set,saleTypes:new Set,unitCounts:{},revenueUSD:0,revenueKHR:0,clients:new Set};g.forEach(w=>{w.items&&w.items.length>0&&w.items.forEach(v=>{let P=v.type==="wholesale"?"បោះដុំ":"លក់រាយ";if(n.value==="all"||n.value===P){b=!0;let I=v.name||"មិនស្គាល់ឈ្មោះ";c.productNames.add(I),c.saleTypes.add(P);const L=(v.unit||"unknown").toLowerCase().trim();c.unitCounts[L]||(c.unitCounts[L]=0),c.unitCounts[L]+=Number(v.qty||0);const D=Number(v.qty||0)*Number(v.price||0);w.currency==="USD"||w.currency==="$"?c.revenueUSD+=D:c.revenueKHR+=D,c.clients.add(w.receiptId)}})}),b?t.push({...o,uniqueId:`${o.id}_report`,productName:Array.from(c.productNames).join(", "),saleType:Array.from(c.saleTypes).join(" & "),totalClients:c.clients.size,revenueUSD:c.revenueUSD,revenueKHR:c.revenueKHR,unitCounts:c.unitCounts,hasSales:!0}):n.value==="all"&&t.push({...o,uniqueId:`${o.id}_empty`,hasSales:!1})}),t.sort((o,g)=>o.hasSales&&!g.hasSales?-1:!o.hasSales&&g.hasSales?1:(g.revenueUSD||0)-(o.revenueUSD||0))});ee(z,a=>{a==="report"&&(le.value="list"),N.value=1}),ee(n,()=>{N.value=1}),ee(E,()=>{N.value=1});const F=B(()=>{if(!E.value)return be.value;const a=E.value.toLowerCase().trim();return be.value.filter(t=>t.fullName&&t.fullName.toLowerCase().includes(a)||t.idNumber&&t.idNumber.toLowerCase().includes(a)||t.productName&&t.productName.toLowerCase().includes(a))}),xe=B(()=>Math.ceil(F.value.length/oe)||1),ke=B(()=>{const a=(N.value-1)*oe;return F.value.slice(a,a+oe)}),$e=()=>{N.value>1&&N.value--},Se=()=>{N.value<xe.value&&N.value++},Ce=a=>{N.value=a},Te=a=>{a&&m.push({name:"SellerSalesDetail",params:{id:a}})},q=B(()=>{let a={all:{usd:0,khr:0,clients:0,totalUnitsCount:0,units:{}}};return z.value==="sellers"||F.value.forEach(t=>{if(t.hasSales){a.all.clients+=t.totalClients||0,a.all.usd+=t.revenueUSD||0,a.all.khr+=t.revenueKHR||0;for(const[o,g]of Object.entries(t.unitCounts||{}))g>0&&(a.all.units[o]=(a.all.units[o]||0)+g,a.all.totalUnitsCount+=g)}}),a}),De=B(()=>{let a="";if(y.value==="daily"&&(a=new Intl.DateTimeFormat("km-KH",{dateStyle:"long"}).format(new Date(T.value))),y.value==="monthly"&&(a=`ខែ ${ae[_.value]} ឆ្នាំ ${C.value}`),y.value==="yearly"&&(a=`ឆ្នាំ ${C.value}`),y.value==="custom"){const o=new Intl.DateTimeFormat("km-KH",{dateStyle:"medium"}).format(new Date(W.value)),g=new Intl.DateTimeFormat("km-KH",{dateStyle:"medium"}).format(new Date(G.value));a=`${o} ដល់ ${g}`}const t=n.value==="all"?"សរុប (All)":n.value;return z.value==="report"?`${a} - ${t}`:a}),se=a=>{if(!a)return"";const t=String(a),o=p.value.find(b=>String(b.value)===t);if(o)return o.label;const g=t.toLowerCase().trim();return g==="bottle"||g==="bottles"?"ដប":g==="pack"||g==="packs"?"កញ្ចប់":g==="case"||g==="cases"?"កេះ":t},Me=()=>{const t=z.value==="report"?`Sales_Report_${d.value?.fullName}`:`Sellers_List_${d.value?.fullName}`,o=F.value.map((w,v)=>({...w,printIndex:v+1})),g=fe(o,1,1,!0),b=document.createElement("iframe");b.style.position="absolute",b.style.width="0",b.style.height="0",b.style.border="none",document.body.appendChild(b);const c=b.contentWindow.document;c.open(),c.write(`
        <html>
        <head>
            <title>${t}</title>
            <link href="https://fonts.googleapis.com/css2?family=Battambong:wght@400;700;900&display=swap" rel="stylesheet">
            <style>
                @page { size: A4 portrait; margin: 0; }
                body { font-family: 'Battambong', sans-serif; -webkit-print-color-adjust: exact !important; print-color-adjust: exact !important; margin: 0; padding: 15mm; background-color: white; }
                table { width: 100%; border-collapse: collapse; }
                tr { page-break-inside: avoid; page-break-after: auto; }
                thead { display: table-header-group; }
            </style>
        </head>
        <body>${g}</body>
        </html>
    `),c.close(),b.contentWindow.document.fonts.ready.then(()=>{b.contentWindow.focus(),b.contentWindow.print(),setTimeout(()=>{document.body.removeChild(b)},1e3)})},ze=async()=>{j.value={active:!0,message:"កំពុងបំបែកទិន្នន័យ...",progress:10};const a=z.value==="report";try{const t=[];let o=[...F.value],g=1;for(;o.length>0;){let v=a?8:14;a&&o.length<=v&&o.length>5&&(v=5),t.push(o.slice(0,v).map(P=>({...P,printIndex:g++}))),o=o.slice(v)}const b=new Oe("p","mm","a4"),c=210;for(let v=0;v<t.length;v++){j.value.message=`កំពុងថតចម្លងទំព័រទី ${v+1} នៃ ${t.length}...`,O.value.innerHTML=fe(t[v],v+1,t.length,!1),await qe(),await document.fonts.ready,await new Promise(K=>setTimeout(K,600));const I=(await Ke(O.value.querySelector(".print-page"),{scale:2,useCORS:!0,logging:!1,backgroundColor:"#ffffff",windowWidth:1e3})).toDataURL("image/jpeg",1);v>0&&b.addPage();const L=b.getImageProperties(I),D=L.height*c/L.width;b.addImage(I,"JPEG",0,0,c,D),j.value.progress=10+Math.round((v+1)/t.length*80)}j.value.message="កំពុងរក្សាទុកឯកសារ...",j.value.progress=100;const w=a?`Sales_Report_${d.value?.fullName}.pdf`:`Sellers_List_${d.value?.fullName}.pdf`;b.save(w)}catch{alert("មិនអាចទាញយក PDF បានទេ")}finally{O.value&&(O.value.innerHTML=""),j.value.active=!1}},fe=(a,t,o,g=!1)=>{const b=z.value==="report";let c=a,w=null;g&&a.length>0&&b&&(c=a.slice(0,a.length-1),w=a[a.length-1]);const v=k=>{if(b){let J=k.hasSales?'<div style="overflow: hidden;">'+Object.entries(k.unitCounts||{}).filter(([U,Q])=>Q>0).map(([U,Q])=>`<div style="float: left; margin: 0 12px 6px 0;">
                        <span style="font-weight: 900; color: #1e293b; font-size: 14px;">${Q.toLocaleString()}</span>
                        <span style="color: #64748b; font-size: 12px; font-weight: bold; margin-left: 4px;">${se(U)}</span>
                     </div>`).join("")+'<div style="clear: both;"></div></div>':'<span style="color:#94a3b8; font-size:12px; font-weight:bold;">គ្មានការលក់</span>',re=k.hasSales?`<div style="text-align: right;">
                    <span style="color:#059669; font-size:16px; font-weight:900; display: inline-block;">${k.revenueUSD?.toLocaleString()||0} $</span><br/>
                    <span style="color:#2563eb; font-size:13px; font-weight:bold; display: inline-block; margin-top: 2px;">${k.revenueKHR?.toLocaleString()||0} ៛</span>
                </div>`:'<div style="text-align: right; color:#94a3b8; font-weight:bold; font-size:14px;">-</div>';const X=`<span style="color: #475569; font-size: 13px; font-weight: bold;">${k.saleType}</span>`;return`
                <tr style="break-inside: avoid; page-break-inside: avoid; border-bottom: 1px dashed #e2e8f0;">
                    <td style="padding: 16px 10px; text-align: center; vertical-align: top; color: #94a3b8; font-weight: 900;">${k.printIndex}</td>
                    <td style="padding: 16px 10px; vertical-align: top;">
                        <p style="font-weight: bold; color: #1e293b; font-size: 15px; margin: 0;">${k.fullName}</p>
                        <p style="font-family: monospace; color: #64748b; font-size: 11px; margin: 4px 0 0 0;">ID: ${k.idNumber||"N/A"}</p>
                    </td>
                    <td style="padding: 16px 10px; vertical-align: top; font-weight: bold; color: #1e293b; font-size: 14px;">${k.hasSales?k.productName:"-"}</td>
                    <td style="padding: 16px 10px; vertical-align: top;">${J}</td>
                    <td style="padding: 16px 10px; vertical-align: top; text-align: center;">${k.hasSales?X:"-"}</td>
                    <td style="padding: 16px 10px; text-align: center; vertical-align: top; font-weight: bold; color: #334155; font-size: 15px;">${k.hasSales?(k.totalClients||0)+" នាក់":"-"}</td>
                    <td style="padding: 16px 10px; vertical-align: top;">${re}</td>
                </tr>
            `}else return`
                <tr style="border-bottom: 1px dashed #e2e8f0; break-inside: avoid; page-break-inside: avoid;">
                    <td style="padding: 16px 10px; text-align: center; vertical-align: middle; font-weight: 900; color: #94a3b8; font-size: 14px;">${k.printIndex}</td>
                    <td style="padding: 16px 10px; vertical-align: middle;"><p style="font-weight: bold; color: #1e293b; font-size: 15px; margin: 0;">${k.fullName}</p></td>
                    <td style="padding: 16px 10px; text-align: center; vertical-align: middle; font-weight: bold; color: #475569; font-size: 13px;">${k.idNumber||"-"}</td>
                    <td style="padding: 16px 10px; text-align: center; vertical-align: middle; font-weight: bold; color: #475569; font-size: 13px;">${k.phoneNumber||"-"}</td>
                </tr>
            `},P=c.map(v).join(""),I=w?v(w):"";let L="";t===1&&(L=`
            <div style="border-bottom: 2px solid #e2e8f0; padding-bottom: 20px; margin-bottom: 25px; overflow: hidden;">
                <div style="float: left;">
                    <p style="font-size: 12px; color: #64748b; font-weight: bold; text-transform: uppercase; margin: 0 0 5px 0;">អ្នកគ្រប់គ្រង (Admin)</p>
                    <h2 style="font-size: 24px; font-weight: 900; color: #0f172a; margin: 0 0 8px 0;">${d.value?.fullName||"N/A"}</h2>
                    <span style="font-size: 14px; color: #475569; font-weight: bold;">@${d.value?.username||"N/A"} ${d.value?.telegram?`| Tel: ${d.value.telegram}`:""}</span>
                </div>
                <div style="float: right; margin-top: 15px;">
                    <span style="border: 2px solid #cbd5e1; color: #334155; padding: 8px 16px; border-radius: 8px; font-weight: bold; font-size: 14px;">តំណាងលក់សរុប: ${s.value?.length||0} នាក់</span>
                </div>
                <div style="clear: both;"></div>
            </div>
        `);let D="";if(b&&(t===o||g)){const k=Object.entries(q.value.all.units);let J="";for(let U=0;U<k.length;U+=2){const[Q,Le]=k[U],ie=k[U+1],Ne=`<td style="width: 50%; padding: 6px 16px 6px 0; vertical-align: top;"><div style="overflow: hidden; border-bottom: 1px dotted #e2e8f0; padding-bottom: 4px;"><span style="color: #475569; font-size: 14px; font-weight: bold; float: left;">${se(Q)}</span><span style="font-weight: 900; color: #0f172a; font-size: 16px; float: right;">${Le.toLocaleString()}</span><div style="clear: both;"></div></div></td>`,Pe=ie?`<td style="width: 50%; padding: 6px 0 6px 16px; vertical-align: top;"><div style="overflow: hidden; border-bottom: 1px dotted #e2e8f0; padding-bottom: 4px;"><span style="color: #475569; font-size: 14px; font-weight: bold; float: left;">${se(ie[0])}</span><span style="font-weight: 900; color: #0f172a; font-size: 16px; float: right;">${ie[1].toLocaleString()}</span><div style="clear: both;"></div></div></td>`:'<td style="width: 50%;"></td>';J+=`<tr>${Ne}${Pe}</tr>`}const re=k.length>0?`<table style="width: 100%; border-collapse: collapse; border: none;"><tbody>${J}</tbody></table>`:'<p style="color: #94a3b8; font-size: 14px; margin: 0;">គ្មានទិន្នន័យ</p>',X=n.value==="all"?"":`- ${n.value}`;D=`
            <div style="margin-top: 40px; border-top: 2px solid #cbd5e1; padding-top: 30px; overflow: hidden; break-inside: avoid; page-break-inside: avoid; width: 100%; display: table;">
                <div style="display: table-cell; width: 60%; padding-right: 30px; vertical-align: top;">
                    <div style="margin-bottom: 16px; overflow: hidden; border-bottom: 2px solid #e2e8f0; padding-bottom: 8px;">
                        <h3 style="font-size: 16px; font-weight: 900; color: #1e293b; margin: 0; float: left;">សរុបបរិមាណលក់តាមប្រភេទ ${X}</h3>
                        <div style="clear: both;"></div>
                    </div>
                    <div>${re}</div>
                </div>
                <div style="display: table-cell; width: 40%; vertical-align: top; border-left: 1px solid #e2e8f0; padding-left: 30px;">
                    <div style="margin-bottom: 16px; border-bottom: 2px solid #e2e8f0; padding-bottom: 8px;">
                        <h3 style="font-size: 16px; font-weight: 900; color: #1e293b; margin: 0;">សរុបរួម (Grand Total) ${X}</h3>
                    </div>
                    <div>
                        <table style="width: 100%; border-collapse: collapse; border: none;">
                            <tr><td style="padding-bottom: 12px; color: #64748b; font-size: 14px; font-weight: bold;">អតិថិជនសរុប:</td><td style="padding-bottom: 12px; text-align: right; font-weight: 900; color: #0f172a; font-size: 16px;">${q.value.all.clients.toLocaleString()} នាក់</td></tr>
                            <tr><td style="padding-top: 12px; padding-bottom: 8px; border-top: 1px dashed #cbd5e1; color: #64748b; font-size: 14px; font-weight: bold;">ចំណូល (USD):</td><td style="padding-top: 12px; padding-bottom: 8px; border-top: 1px dashed #cbd5e1; text-align: right; font-weight: 900; color: #059669; font-size: 22px;">${q.value.all.usd.toLocaleString()} $</td></tr>
                            <tr><td style="padding-top: 4px; color: #64748b; font-size: 14px; font-weight: bold;">ចំណូល (KHR):</td><td style="padding-top: 4px; text-align: right; font-weight: 900; color: #2563eb; font-size: 16px;">${q.value.all.khr.toLocaleString()} ៛</td></tr>
                        </table>
                    </div>
                </div>
            </div>
        `}const K=g?"width: 100%; box-sizing: border-box; font-family: 'Battambong', sans-serif; line-height: 1.6; padding: 20px;":"width: 1000px; min-height: 1414px; background: white; padding: 40px; box-sizing: border-box; font-family: 'Battambong', sans-serif; line-height: 1.6; position: relative;",je=b?"របាយការណ៍លក់តាមតំណាងលក់":"បញ្ជីរាយនាមតំណាងលក់",ve=b?'<th style="padding: 16px 10px; width: 5%; text-align: center; border-bottom: 2px solid #cbd5e1;">#</th><th style="padding: 16px 10px; width: 25%; border-bottom: 2px solid #cbd5e1;">តំណាងលក់</th><th style="padding: 16px 10px; width: 20%; border-bottom: 2px solid #cbd5e1;">ប្រភេទ (ទំនិញ)</th><th style="padding: 16px 10px; width: 15%; border-bottom: 2px solid #cbd5e1;">ចំនួនលក់</th><th style="padding: 16px 10px; width: 10%; text-align: center; border-bottom: 2px solid #cbd5e1;">ការលក់</th><th style="padding: 16px 10px; width: 10%; text-align: center; border-bottom: 2px solid #cbd5e1;">អតិថិជនសរុប</th><th style="padding: 16px 10px; width: 15%; text-align: right; border-bottom: 2px solid #cbd5e1;">ចំណូល</th>':'<th style="padding: 16px 10px; width: 5%; text-align: center; border-bottom: 2px solid #cbd5e1;">#</th><th style="padding: 16px 10px; border-bottom: 2px solid #cbd5e1;">តំណាងលក់</th><th style="padding: 16px 10px; text-align: center; border-bottom: 2px solid #cbd5e1;">អត្តលេខ</th><th style="padding: 16px 10px; text-align: center; border-bottom: 2px solid #cbd5e1;">លេខទូរស័ព្ទ</th>';let ne="";return g&&b?ne=`<table style="width: 100%; text-align: left; border-collapse: collapse; background-color: #ffffff;"><thead style="color: #334155; font-size: 13px; font-weight: 900; display: table-header-group; text-transform: uppercase;"><tr>${ve}</tr></thead><tbody>${P}</tbody><tbody style="break-inside: avoid; page-break-inside: avoid;">${I}<tr><td colspan="7" style="padding: 0; border: none;">${D}</td></tr></tbody></table>`:ne=`<table style="width: 100%; text-align: left; border-collapse: collapse; background-color: #ffffff;"><thead style="color: #334155; font-size: 13px; font-weight: 900; display: table-header-group; text-transform: uppercase;"><tr>${ve}</tr></thead><tbody>${P}${I}</tbody></table>${D}`,`
        <div class="print-page" style="${K}">
            <div style="text-align: center; margin-bottom: 30px; padding-bottom: 20px;">
                <h1 style="font-size: 28px; font-weight: 900; color: #1e293b; margin: 0; text-transform: uppercase;">${je}</h1>
            </div>
            ${L}
            <div style="flex: 1;">${ne}</div>
            <div style="margin-top: 40px; padding-top: 15px; border-top: 1px solid #e2e8f0; font-size: 12px; font-weight: bold; color: #94a3b8; overflow: hidden;">
                <div style="float: left;"><span style="color: #475569; font-size: 14px; font-weight: 900;">កាលបរិច្ឆេទ: ${De.value}</span> &nbsp;&nbsp;|&nbsp;&nbsp;ថ្ងៃបញ្ចេញរបាយការណ៍: ${new Date().toLocaleString("km-KH")}</div>
                <div style="float: right;">${g?"":`ទំព័រទី ${t} នៃ ${o}`}</div><div style="clear: both;"></div>
            </div>
        </div>
    `};return(a,t)=>(r(),i("div",Qo,[te(ft,{dateFilterType:y.value,"onUpdate:dateFilterType":t[0]||(t[0]=o=>y.value=o),selectedDate:T.value,"onUpdate:selectedDate":t[1]||(t[1]=o=>T.value=o),selectedMonth:_.value,"onUpdate:selectedMonth":t[2]||(t[2]=o=>_.value=o),selectedYear:C.value,"onUpdate:selectedYear":t[3]||(t[3]=o=>C.value=o),customStart:W.value,"onUpdate:customStart":t[4]||(t[4]=o=>W.value=o),customEnd:G.value,"onUpdate:customEnd":t[5]||(t[5]=o=>G.value=o),availableYears:ye.value,availableMonths:ge.value,isLoadingPage:h.value},null,8,["dateFilterType","selectedDate","selectedMonth","selectedYear","customStart","customEnd","availableYears","availableMonths","isLoadingPage"]),h.value?(r(),i("div",Vo,[...t[10]||(t[10]=[e("div",{class:"animate-spin rounded-full h-12 w-12 border-4 border-slate-200 border-t-indigo-600 mb-4"},null,-1),e("p",{class:"text-slate-500 font-bold tracking-wide"},"កំពុងទាញយកទិន្នន័យ...",-1)])])):(r(),i("div",Wo,[te(Ft,{admin:d.value,totalSellersCount:s.value.length,activeTab:z.value,"onUpdate:activeTab":t[6]||(t[6]=o=>z.value=o),searchQuery:E.value,"onUpdate:searchQuery":t[7]||(t[7]=o=>E.value=o),activeCategory:n.value,"onUpdate:activeCategory":t[8]||(t[8]=o=>n.value=o),filteredSellersLength:F.value.length,processing:j.value,onPrint:Me,onPdf:ze},null,8,["admin","totalSellersCount","activeTab","searchQuery","activeCategory","filteredSellersLength","processing"]),te(Po,{activeTab:z.value,filteredSellers:F.value,paginatedSellers:ke.value,currentPage:N.value,totalPages:xe.value,itemsPerPage:oe,unitSettings:p.value,viewMode:le.value,"onUpdate:viewMode":t[9]||(t[9]=o=>le.value=o),onGoToPage:Ce,onPrevPage:$e,onNextPage:Se,onGoToSellerDetail:Te},null,8,["activeTab","filteredSellers","paginatedSellers","currentPage","totalPages","unitSettings","viewMode"])])),!h.value&&z.value==="report"&&F.value.some(o=>o.hasSales)?(r(),Be(Ko,{key:2,grandTotals:q.value,unitSettings:p.value},null,8,["grandTotals","unitSettings"])):S("",!0),te(Re,{"enter-active-class":"duration-300 ease-out","enter-from-class":"opacity-0","enter-to-class":"opacity-100","leave-active-class":"duration-200 ease-in","leave-from-class":"opacity-100","leave-to-class":"opacity-0"},{default:Ue(()=>[j.value.active?(r(),i("div",Go,[e("div",Jo,[e("div",Xo,[t[11]||(t[11]=e("div",{class:"absolute inset-0 rounded-full border-4 border-white/5"},null,-1)),t[12]||(t[12]=e("div",{class:"absolute inset-0 rounded-full border-4 border-t-rose-500 border-r-rose-500 border-b-transparent border-l-transparent animate-spin"},null,-1)),e("div",Zo,x(j.value.progress)+"%",1)]),e("h3",ea,x(j.value.message),1),e("div",ta,[e("div",{class:"h-full bg-gradient-to-r from-red-500 to-rose-600 transition-all duration-300 ease-out",style:Ee({width:`${j.value.progress}%`})},null,4)])])])):S("",!0)]),_:1}),e("div",{ref_key:"printStaging",ref:O,class:"fixed top-0 left-[-9999px] pointer-events-none z-[-1] opacity-0 print:opacity-100"},null,512)]))}},la=V(oa,[["__scopeId","data-v-1de58bb0"]]);export{la as default};
